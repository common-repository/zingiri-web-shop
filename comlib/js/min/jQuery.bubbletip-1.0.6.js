(function(b){var a=0;b.fn.extend({bubbletip:function(o,t){if(b("table.bubbletip #"+b(o).get(0).id).length>0){return this}var l,c,q,f,h,n,s,j,r,g;var i,d;l=b(this);c=b(o);g=a++;q={positionAt:"element",positionAtElement:l,offsetTop:0,offsetLeft:0,deltaPosition:30,deltaDirection:"up",animationDuration:250,animationEasing:"swing",bindShow:"mouseover",bindHide:"mouseout",delayShow:0,delayHide:500,calculateOnShow:false};if(t){q=b.extend(q,t)}f={top:0,left:0,delta:0,mouseTop:0,mouseLeft:0,tipHeight:0,bindShow:(q.bindShow+" ").replace(/ +/g,".bubbletip"+g),bindHide:(q.bindHide+" ").replace(/ +/g,".bubbletip"+g)};h=null;n=null;s=false;j=false;if(!l.data("bubbletip_tips")){l.data("bubbletip_tips",[[c.get(0).id,g]])}else{l.data("bubbletip_tips",b.merge(l.data("bubbletip_tips"),[[c.get(0).id,g]]))}if(!q.positionAt.match(/^element|body|mouse$/i)){q.positionAt="element"}if(!q.deltaDirection.match(/^up|down|left|right$/i)){q.deltaDirection="up"}if(q.deltaDirection.match(/^up$/i)){r=b('<table class="bubbletip" cellspacing="0" cellpadding="0"><tbody><tr><td class="bt-topleft"></td><td class="bt-top"></td><td class="bt-topright"></td></tr><tr><td class="bt-left"></td><td class="bt-content"></td><td class="bt-right"></td></tr><tr><td class="bt-bottomleft"></td><td><table class="bt-bottom" cellspacing="0" cellpadding="0"><tr><th></th><td><div></div></td><th></th></tr></table></td><td class="bt-bottomright"></td></tr></tbody></table>')}else{if(q.deltaDirection.match(/^down$/i)){r=b('<table class="bubbletip" cellspacing="0" cellpadding="0"><tbody><tr><td class="bt-topleft"></td><td><table class="bt-top" cellspacing="0" cellpadding="0"><tr><th></th><td><div></div></td><th></th></tr></table></td><td class="bt-topright"></td></tr><tr><td class="bt-left"></td><td class="bt-content"></td><td class="bt-right"></td></tr><tr><td class="bt-bottomleft"></td><td class="bt-bottom"></td><td class="bt-bottomright"></td></tr></tbody></table>')}else{if(q.deltaDirection.match(/^left$/i)){r=b('<table class="bubbletip" cellspacing="0" cellpadding="0"><tbody><tr><td class="bt-topleft"></td><td class="bt-top"></td><td class="bt-topright"></td></tr><tr><td class="bt-left"></td><td class="bt-content"></td><td class="bt-right-tail"><div class="bt-right"></div><div class="bt-right-tail"></div><div class="bt-right"></div></td></tr><tr><td class="bt-bottomleft"></td><td class="bt-bottom"></td><td class="bt-bottomright"></td></tr></tbody></table>')}else{if(q.deltaDirection.match(/^right$/i)){r=b('<table class="bubbletip" cellspacing="0" cellpadding="0"><tbody><tr><td class="bt-topleft"></td><td class="bt-top"></td><td class="bt-topright"></td></tr><tr><td class="bt-left-tail"><div class="bt-left"></div><div class="bt-left-tail"></div><div class="bt-left"></div></td><td class="bt-content"></td><td class="bt-right"></td></tr><tr><td class="bt-bottomleft"></td><td class="bt-bottom"></td><td class="bt-bottomright"></td></tr></tbody></table>')}}}}r.appendTo("body");if((/msie/.test(navigator.userAgent.toLowerCase()))&&(!/opera/.test(navigator.userAgent.toLowerCase()))){b("*",r).each(function(){var u=b(this).css("background-image");if(u.match(/^url\(["']?(.*\.png)["']?\)$/i)){u=RegExp.$1;b(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod="+(b(this).css("backgroundRepeat")=="no-repeat"?"crop":"scale")+", src='"+u+"')"}).each(function(){var v=b(this).css("position");if(v!="absolute"&&v!="relative"){b(this).css("position","relative")}})}})}b(".bt-content",r).append(c);c.show();if(q.deltaDirection.match(/^left|right$/i)){f.tipHeight=parseInt(c.height()/2);if((c.height()%2)==1){f.tipHeight++}f.tipHeight=(f.tipHeight<20)?1:f.tipHeight-20;if(q.deltaDirection.match(/^left$/i)){b("div.bt-right",r).css("height",f.tipHeight+"px")}else{b("div.bt-left",r).css("height",f.tipHeight+"px")}}r.css("opacity",0);r.css({width:r.width(),height:r.height()});k();r.hide();b(window).bind("resize.bubbletip"+g,function(){var u=b(window).width();var v=b(window).height();if((u===i)&&(v===d)){return}i=u;d=v;if(n){clearTimeout(n)}n=setTimeout(function(){k()},250)});b([r.get(0),this.get(0)]).bind(f.bindShow,function(){if(h){clearTimeout(h)}if(q.delayShow===0){p()}else{h=setTimeout(function(){p()},q.delayShow)}return false}).bind(f.bindHide,function(){if(h){clearTimeout(h)}if(q.delayHide===0){m()}else{h=setTimeout(function(){m()},q.delayHide)}return false});function p(){var u;if(s){return}s=true;if(j){r.stop(true,false)}if(q.calculateOnShow){k()}if(q.positionAt.match(/^element|body$/i)){if(q.deltaDirection.match(/^up|down$/i)){if(!j){r.css("top",parseInt(f.top+f.delta)+"px")}u={top:f.top+"px"}}else{if(!j){r.css("left",parseInt(f.left+f.delta)+"px")}u={left:f.left+"px"}}}else{if(q.deltaDirection.match(/^up|down$/i)){if(!j){f.mouseTop=e.pageY+f.top;r.css({top:parseInt(f.mouseTop+f.delta)+"px",left:parseInt(e.pageX-(r.width()/2))+"px"})}u={top:f.mouseTop+"px"}}else{if(!j){f.mouseLeft=e.pageX+f.left;r.css({left:parseInt(f.mouseLeft+f.delta)+"px",top:parseInt(e.pageY-(r.height()/2))+"px"})}u={left:f.left+"px"}}}j=false;r.show();u=b.extend(u,{opacity:1});r.animate(u,q.animationDuration,q.animationEasing,function(){r.css("opacity","");s=true})}function m(){var u;s=false;j=true;if(q.positionAt.match(/^element|body$/i)){if(q.deltaDirection.match(/^up|down$/i)){u={top:parseInt(f.top-f.delta)+"px"}}else{u={left:parseInt(f.left-f.delta)+"px"}}}else{if(q.deltaDirection.match(/^up|down$/i)){u={top:parseInt(f.mouseTop-f.delta)+"px"}}else{u={left:parseInt(f.mouseLeft-f.delta)+"px"}}}u=b.extend(u,{opacity:0});r.animate(u,q.animationDuration,q.animationEasing,function(){r.hide();j=false})}function k(){if(q.positionAt.match(/^element$/i)){var u=q.positionAtElement.offset();if(q.deltaDirection.match(/^up$/i)){f.top=u.top+q.offsetTop-r.outerHeight();f.left=u.left+q.offsetLeft+((q.positionAtElement.outerWidth()-r.outerWidth())/2);f.delta=q.deltaPosition}else{if(q.deltaDirection.match(/^down$/i)){f.top=u.top+q.positionAtElement.outerHeight()+q.offsetTop;f.left=u.left+q.offsetLeft+((q.positionAtElement.outerWidth()-r.outerWidth())/2);f.delta=-q.deltaPosition}else{if(q.deltaDirection.match(/^left$/i)){f.top=u.top+q.offsetTop+((q.positionAtElement.outerHeight()-r.outerHeight())/2);f.left=u.left+q.offsetLeft-r.outerWidth();f.delta=q.deltaPosition}else{if(q.deltaDirection.match(/^right$/i)){f.top=u.top+q.offsetTop+((q.positionAtElement.outerHeight()-r.outerHeight())/2);f.left=u.left+q.positionAtElement.outerWidth()+q.offsetLeft;f.delta=-q.deltaPosition}}}}}else{if(q.positionAt.match(/^body$/i)){if(q.deltaDirection.match(/^up|left$/i)){f.top=q.offsetTop;f.left=q.offsetLeft;f.delta=q.deltaPosition}else{if(q.deltaDirection.match(/^down$/i)){f.top=parseInt(q.offsetTop+r.outerHeight());f.left=q.offsetLeft}else{f.top=q.offsetTop;f.left=parseInt(q.offsetLeft+r.outerWidth())}f.delta=-q.deltaPosition}}else{if(q.positionAt.match(/^mouse$/i)){if(q.deltaDirection.match(/^up|left$/i)){if(q.deltaDirection.match(/^up$/i)){f.top=-(q.offsetTop+r.outerHeight());f.left=q.offsetLeft}else{if(q.deltaDirection.match(/^left$/i)){f.top=q.offsetTop;f.left=-(q.offsetLeft+r.outerWidth())}}f.delta=q.deltaPosition}else{f.top=q.offsetTop;f.left=q.offsetLeft;f.delta=-q.deltaPosition}}}}if(q.positionAt.match(/^element|body$/i)){r.css({position:"absolute",top:f.top+"px",left:f.left+"px"})}}return this},removeBubbletip:function(f){var j;var l=new Array();var d=new Array();var c,h,g;var k;j=b.makeArray(b(this).data("bubbletip_tips"));c=b.makeArray(f);for(h=0;h<c.length;h++){l.push(b(c[h]).get(0).id)}for(h=0;h<j.length;h++){g=null;if((l.length==0)||((g=b.inArray(j[h][0],l))>=0)){k=b("#"+j[h][0]).get(0).parentNode;while(k.tagName.toLowerCase()!="table"){k=k.parentNode}b("#"+j[h][0]).appendTo("body").hide();b(k).remove();b(this).unbind(".bubbletip"+j[h][1]);b(window).unbind(".bubbletip"+j[h][1])}else{d.push(j[h])}}b(this).data("bubbletip_tips",d);return this}})})(jQuery);